# THIS IS A CYLC TASK DEFINITION FILE

%TASK
    ext_get_frames_ukmet, e_g_fr_uk

%DESCRIPTION
    Get the UK MetOffice Frame files

%TYPE
    free, sequential

%OWNER
    ecoconnect

%HOURS
    0,6,12,18

%ENVIRONMENT
    PREV_CYCLE_TIME   $( cylcutil cycle-time -s 6 )
    YMD ${PREV_CYCLE_TIME:0:8}
    HH  ${PREV_CYCLE_TIME:8:2}
    SRCE    ftpops.metoffice.gov.uk
    SRCE_LOC    ~/
    DEST_LOC    ${HOME}/output
    FILENAME    ${YMD}_frame_qg${HH}_niwa_*.gz
    SRCE_USER   niwa
    SERVICE     ext_get_frames_ukmet
    KEEP    1
    FAST    3
    FILEOUT     ${YMD}_frame_qg${HH}_niwa_*.gz
    TIMEOUT 5
    CHECKSUM    1
    CHECKFILE   ${PREV_CYCLE_TIME}_frames_checksum.txt

%COMMAND
    cylc-wrapper file_transfer_ftp.sh

%PREREQUISITES
    "UM global $(CYCLE_TIME-6) frame files available for download"

%OUTPUTS
    "UM global $(CYCLE_TIME-6) frame files ready"
