# THIS IS A SEQUENZ TASK CLASS DEFINITION FILE
# See full_template.def for documented entries

%NAME
    foo

%OWNER
    # specify task owner username here
    # LEAVE UNSPECIFIED IF YOU WANT THE TASK TO RUN AS THE SEQUENZ USER
    user_foo

%VALID_HOURS
    # list of comma separated hours
    6,18

%EXTERNAL_TASK
    # script to invoke when my prerequisites are all satisfied
    run_foo.sh

%PREREQUISITES
    # ZERO OR MORE prerequisite messages, each on a separate line.
    # May contain:
    #  1. $(MY_REFERENCE_TIME)
    #  2. $(MY_REFERENCE_TIME - <hours>)
    # ALL listed prerequisites must be satisfied for this task to run

    # For requisites that depend on reference hour, prefix with
    # a comma-separated hour list followed by the '|' character.
    # (USE NO PREFIX FOR REQUISTES THAT APPLY IN ALL VALID HOURS).

    bar finished for $(MY_REFERENCE_TIME)
    0,12 | file baz_$(MY_REFERENCE_TIME)_utc.nc ready

%RUN_LENGTH
    # Estimated run length in minutes. This is used to properly simulate
    # the behaviour the task in dummy mode.
    20 min

%OUTPUTS
    # List any output messages that are important for task sequencing
    # purposes (i.e. that other tasks may depend on), on separate lines.
    # Each must be prefixed by estimated completion time in minutes. 
    # May contain:
    #  1. $(NAME) 
    #  2. $(MY_REFERENCE_TIME)
    #  3. $(MY_REFERENCE_TIME - <hours>)
    # But do not add 'started' and 'finished' messages; these are
    # generated automatically according to the estimated run length:
    #   0 min: $(NAME) started for $(MY_REFERENCE_TIME)
    #   L min: $(NAME) finished for $(MY_REFERENCE_TIME)

    # ALL listed outputs must be completed for the task to finish,
    # but tasks may send additional messages from those listed here,
    # for progess monitoring and logging purposes.

    # For outputs that depend on reference hour, see the documentation
    # on PREREQUISITES above.

    10 min: file foo_0_$(MY_REFERENCE_TIME).nc ready
    0,12 | 15 min: file foo_1_$(MY_REFERENCE_TIME).nc ready
    6,18 | 15 min: file foo_2_$(MY_REFERENCE_TIME).nc ready

# NOTE that prerequisite and output messages are literal strings (with
# some limited variable substitution) and prerequisite-output matching
# is exact, so be careful of white space, spelling errors, etc.

# NOTE that some tasks may have no listed prerequisites (these will run
# immediately after launch) and/or not outputs (in which case other
# tasks may depend on their automatically supplied 'started' or
# 'finished' messages. 

# OPTIONAL:
%DELAYED_DEATH
    # THIS KEY IS OPTIONAL and defaults to 'False'. Any task that has
    # only cotemporal downstream dependents (i.e. all normal tasks) can
    # be killed  as soon as it is finished AND there are no other
    # tasks yet to be finished at its reference time or earlier.
    # Specify delayed death for any tasks with downstream dependents in
    # later reference times, in which case they will be killed only when
    # the cutoff time specified by their dependents is reached.
    True

# OPTIONAL:
%EXPORT
    # specify environment variable names and values to passed to the
    # external task. (other than $MY_REFERENCE_TIME and $NAME)
    FOO foo
    BAR bar
