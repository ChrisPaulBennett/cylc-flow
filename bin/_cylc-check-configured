#!/bin/bash

# check that a given directory:
#  (a) is a cylc system definition directory
#  (b) has been configured already

if [[ $# != 1 ]]; then
    echo "_cylc-check-configured ERROR: system def directory required"
    exit 1
fi

DIR=$1

# is $DIR a directory
if [[ ! -d $DIR  ]]; then
    echo "_cylc-check-configured ERROR: $DIR is not a directory"
    exit 1
fi

# is it a cylc system definition directory?
if [[ ! -d $DIR/taskdef/ || ! -d $DIR/scripts ]]; then
    echo "_cylc-check-configured ERROR: $DIR is not a system definition directory"
    exit 1
fi

# has it been configured yet?
if [[ ! -f $DIR/system_config.py || ! -f $DIR/task_classes.py ]]; then
    echo "_cylc-check-configured ERROR: $DIR has not been configured yet"
    exit 1
fi
