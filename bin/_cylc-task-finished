#!/usr/bin/env python

#         __________________________
#         |____C_O_P_Y_R_I_G_H_T___|
#         |                        |
#         |  (c) NIWA, 2008-2010   |
#         | Contact: Hilary Oliver |
#         |  h.oliver@niwa.co.nz   |
#         |    +64-4-386 0461      |
#         |________________________|


""" 
Documentation
"""

import sys
from optparse import OptionParser
from task_message import message
from lockserver import lock


usage = """cylc task-finished [options]

Tell cylc that the calling task has finished successfully. 
"""

parser = OptionParser( usage )

( options, args ) = parser.parse_args()

if len( args ) != 0:
    print >> sys.stderr, "WARNING: ignoring task-finished arguments:"
    for arg in args:
        print sys.stderr, arg

if not lock().release():
    print >> sys.stderr, "WARNING: failed to release task lock"
    sys.exit(1)

message().send_finished()
