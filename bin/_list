#!/usr/bin/env python

import os, sys
from optparse import OptionParser
from config import config, SuiteConfigError

parser = OptionParser( """cylc list [options] SUITE

Print the task list and, optionally, the title and description, of a
registered suite.

Arguments:
   SUITE    - name of the target suite""")

parser.add_option( "-a", "--all", help="print all information "
        "(by default just the task list is printed).",
        action="store_true", default=False, dest="print_all" )

parser.add_option( "-d", "--debug", help="print the full "
        "exception traceback in case of a validation error.",
        action="store_true", default=False, dest="debug" )

#
#parser.add_option( "-o", "--owner", help="suite owner (default $USER).",
#        metavar='USERNAME', action="store", default=os.environ['USER'], 
#        dest="owner" )

(options, args) = parser.parse_args()

if len(args) != 1:
    parser.error( "Wrong number or arguments" )
else:
    suite = args[0]

try:
    config = config( suite )
except SuiteConfigError,x:
    if options.debug:
        raise
    else:
        raise SystemExit(x)

if options.print_all:
    print 'TITLE:'
    print config.get_title()
    print 'DESCRIPTION:'
    print config.get_description()
    print 'TASK LIST:'
for task in config.get_task_name_list():
    print ' ', task
