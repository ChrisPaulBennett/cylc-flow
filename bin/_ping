#!/usr/bin/env python

#from optparse import OptionParser
from CylcOptionParsers import NoPromptOptionParser_u
from port_scan import get_port, SuiteIdentificationError

parser = NoPromptOptionParser_u( """cylc [discover] ping [options] SUITE
    
Check that SUITE is running. 

Arguments:
SUITE             Target suite registration GROUP:NAME.""" )

parser.add_option( "--print-ports",
        help="Print cylc's configured port range.",
        action="store_true",default=False, dest="print_ports" )

( options, args ) = parser.parse_args()

if options.print_ports:
    from cylc_pyro_server import pyro_base_port, pyro_port_range
    print "cylc port range from $CYLC_DIR/src/pyro_server.py:"
    print pyro_base_port, '<= port <=', pyro_base_port + pyro_port_range
    sys.exit(0)

if len( args ) != 1:
    parser.error( "Wrong number of arguments" ) 

suite = args[0]

try:
    port = get_port( suite, owner=options.owner, host=options.host )
except SuiteIdentificationError, x:
    raise SystemExit( x )
