Re-worked graph n-window algorithm for better efficiency.
